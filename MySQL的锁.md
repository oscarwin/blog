# MySQL 的锁

经常可以听到关于 MySQL 锁的概念有：乐观锁、悲观锁、行锁、表锁、Gap锁、DML锁、意向锁、读锁、写锁、共享锁、排它锁。这么锁一听就让人头大，于是去看一些博客，有些讲乐观锁、悲观锁，有些在讲读锁、写锁，于是乐观锁和悲观锁好像理解了，读锁写锁好像也理解了，但是我任然不知道怎么用，也不知道乐观锁与读锁写锁有没有什么关系？再看了很多文章后，逐渐弄懂了它们之间的关系，于是写下这篇文章来梳理思路，如有错误，还请指正。

虽然上面列举了很多锁的名词，但是这些锁其实并不是在同一个维度上的，这就是我之所以懵圈的原因。

## 读锁和写锁

首先共享锁是读锁的别名，排它锁是写锁的别名，也就是说共享锁和读锁是同一个东西，排它锁和写锁是同一个东西。读锁、写锁是系统实现层面上的锁，也是最基础的锁。读锁和写锁的加锁关系如下：

| | 读锁 | 写锁 |
| :---: | :---: | :---: |
| 读锁 | Y | X |
| 写锁 | X | X |

之前的文章已经介绍了 MySQL 的存储模型，对于 InnoDB 引擎而言，采用的是 B+ 树索引，假设需要将整个表锁住那么需要在整个 B+ 树的每个节点上都加上锁，显然这是个非常低效的做法。因此，MySQL 提出了意向锁的概念。